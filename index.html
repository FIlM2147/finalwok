<!DOCTYPE html>
<html>
  <head>
    <title>GLB Models Scene</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        cursor: default;
      }
      
      canvas {
        cursor: crosshair;
      }
      
      /* Crosshair ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö FPS mode */
      .crosshair {
        position: fixed;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin: -10px 0 0 -10px;
        pointer-events: none;
        z-index: 1000;
        display: none;
      }
      
      .crosshair::before,
      .crosshair::after {
        content: '';
        position: absolute;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 2px rgba(0,0,0,0.5);
      }
      
      .crosshair::before {
        width: 2px;
        height: 20px;
        left: 9px;
        top: 0;
      }
      
      .crosshair::after {
        width: 20px;
        height: 2px;
        left: 0;
        top: 9px;
      }
    </style>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/DRACOLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dat.gui@0.7.9/build/dat.gui.min.js"></script>

    <script>
      const renderer = new THREE.WebGLRenderer({
        alpha: true, // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™
        antialias: true,
      });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.shadowMap.enabled = true;
      renderer.shadowMap.type = THREE.PCFSoftShadowMap;

      // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏ß‡∏Å‡∏≤‡∏®
      renderer.outputEncoding = THREE.sRGBEncoding;
      renderer.toneMapping = THREE.ACESFilmicToneMapping;
      renderer.toneMappingExposure = 0.5; // ‡∏•‡∏î‡∏Ñ‡πà‡∏≤ exposure ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô

      renderer.setClearColor(0x000011, 0); // ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÅ‡∏ó‡∏ô‡∏î‡∏≥‡∏™‡∏ô‡∏¥‡∏ó
      document.body.appendChild(renderer.domElement);

      const scene = new THREE.Scene();
      // ‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ scene.background ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ skybox model ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

      // Camera
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      // ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡πâ‡∏≤‡∏¢ ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á

// ‡∏à‡∏∏‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡πâ‡∏≤‡∏¢ (‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ)
const cameraPoints = {
    pbrmodelname:  { pos: new THREE.Vector3(3, 2, 6), rotY: -Math.PI / 3 },
    sign_bunny: { pos: new THREE.Vector3(-2, 1.5, -3), rotY: Math.PI / 2 },
    sign_base:  { pos: new THREE.Vector3(0, 2, 8), rotY: 0 }
};

      camera.position.set(28, 1.5, 1.5);
      
      // ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
      const initialCameraPosition = new THREE.Vector3(28, 1.5, 1.5);
      const initialCameraPitch = Math.PI / 6; // ‡πÄ‡∏≠‡∏µ‡∏¢‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 30 ‡∏≠‡∏á‡∏®‡∏≤
      const initialCameraYaw = 0;
      
      // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
      camera.rotation.order = 'YXZ';
      camera.rotation.x = initialCameraPitch;
      camera.rotation.y = initialCameraYaw;
      
      // FPS Controls - ‡πÉ‡∏ä‡πâ ESC ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î FPS mode
      let pitch = Math.PI / 6, yaw = 0; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∏‡∏°‡πÄ‡∏≠‡∏µ‡∏¢‡∏á
      const mouseSensitivity = 0.002;
      let isPointerLocked = false;
      let isFPSMode = false; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ FPS mode ‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å pointer lock
      
      // Pointer Lock API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö FPS control
      const canvas = renderer.domElement;
      
      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ FPS mode
      function enterFPSMode() {
        if (!isFPSMode) {
          canvas.requestPointerLock();
          isFPSMode = true;
        }
      }
      
      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å FPS mode
      function exitFPSMode() {
        if (isFPSMode) {
          if (document.pointerLockElement) {
            document.exitPointerLock();
          }
          isFPSMode = false;
          isPointerLocked = false;
        }
      }
      
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pointer Lock
      document.addEventListener('pointerlockchange', () => {
        isPointerLocked = document.pointerLockElement === canvas;
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ FPS mode
        if (isFPSMode && isPointerLocked) {
          instructions.style.display = 'none';
          crosshair.style.display = 'block';
        } else {
          instructions.style.display = 'block';
          crosshair.style.display = 'none';
          if (!isPointerLocked) {
            isFPSMode = false; // Reset FPS mode ‡πÄ‡∏°‡∏∑‡πà‡∏≠ pointer lock ‡∏´‡∏•‡∏∏‡∏î
          }
        }
      });
      
      // Mouse movement ‡πÉ‡∏ô FPS mode
      document.addEventListener('mousemove', (event) => {
        if (isFPSMode && isPointerLocked) {
          yaw -= event.movementX * mouseSensitivity;
          pitch -= event.movementY * mouseSensitivity;
          
          // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô-‡∏•‡∏á (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÉ‡∏´‡πâ‡πÅ‡∏Ñ‡∏ö‡∏•‡∏á)
          const minPitch = -Math.PI/6; // ‡∏°‡∏≠‡∏á‡∏•‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà 30 ‡∏≠‡∏á‡∏®‡∏≤
          const maxPitch = Math.PI/3;  // ‡∏°‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà 60 ‡∏≠‡∏á‡∏®‡∏≤
          pitch = Math.max(minPitch, Math.min(maxPitch, pitch));
          
          // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
          camera.rotation.order = 'YXZ';
          camera.rotation.y = yaw;
          camera.rotation.x = pitch;
        }
      });
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
      const instructions = document.createElement('div');
      instructions.style.position = 'absolute';
      instructions.style.top = '10px';
      instructions.style.left = '10px';
      instructions.style.color = 'white';
      instructions.style.backgroundColor = 'rgba(0,0,0,0.8)';
      instructions.style.padding = '15px';
      instructions.style.borderRadius = '8px';
      instructions.style.fontFamily = 'Arial, sans-serif';
      instructions.style.fontSize = '14px';
      instructions.style.zIndex = '1000';
      instructions.innerHTML = `
        <strong>üéÆ Controls:</strong><br>
        <span style="color: #ffff00;">Q</span>: Enter/Exit FPS mode<br>
        <br><strong>üéØ In FPS Mode:</strong><br>
        <span style="color: #00ff00;">WASD</span>: Move around<br>
        <span style="color: #00ff00;">Space</span>: Fly up<br>
        <span style="color: #00ff00;">Shift</span>: Fly down<br>
        <span style="color: #00ff00;">Mouse</span>: Look around<br>
        <span style="color: #ff6600;">Click (aim at center)</span>: Interact<br>
        <span style="color: #ff9900;">Click Back Model</span>: Return home<br>
        <span style="color: #00ffff;">Click Teleport Models</span>: Go to special locations<br>
        <span style="color: #ffff00;">Q</span>: Exit FPS mode
      `;
      document.body.appendChild(instructions);
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏° crosshair
      const crosshair = document.createElement('div');
      crosshair.className = 'crosshair';
      document.body.appendChild(crosshair);

      // Mouse look (‡∏°‡∏≠‡∏á‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏ß)
      document.body.requestPointerLock =
        document.body.requestPointerLock || document.body.mozRequestPointerLock;
      document.body.onclick = () => document.body.requestPointerLock();
      document.addEventListener("mousemove", (e) => {
        if (document.pointerLockElement === document.body) {
          camera.rotation.y -= e.movementX * 0.002;
          camera.rotation.x -= e.movementY * 0.002;
          camera.rotation.x = Math.max(
            -Math.PI / 2,
            Math.min(Math.PI / 2, camera.rotation.x)
          );
        }
      });

      // üîπ GUI ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
      const info = document.createElement("div");
      info.style.position = "fixed";
      info.style.top = "10px";
      info.style.left = "10px";
      info.style.color = "white";
      info.style.background = "rgba(0,0,0,0.5)";
      info.style.padding = "5px 10px";
      info.style.borderRadius = "8px";
      info.style.fontFamily = "monospace";
      info.style.zIndex = "10";
      document.body.appendChild(info);

      // Light - ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏™‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏ß‡∏Å‡∏≤‡∏®‡∏î‡∏π‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô
      scene.add(new THREE.AmbientLight(0x404040, 0.3)); // ‡∏•‡∏î‡∏à‡∏≤‡∏Å 2.0 ‡πÄ‡∏õ‡πá‡∏ô 0.3 ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏ó‡∏≤
      const dirLight = new THREE.DirectionalLight(0xffffff, 0.8); // ‡∏•‡∏î‡∏à‡∏≤‡∏Å 2.0 ‡πÄ‡∏õ‡πá‡∏ô 0.8
      dirLight.position.set(10, 5, 10);
      dirLight.castShadow = true;
      scene.add(dirLight);

      // Add ground plane with texture
      const groundTexture = new THREE.TextureLoader().load(
        "https://film2147.github.io/modelwork3/asphalt-road-texture-dark-gray-color_1017-20231.jpg"
      );
      groundTexture.wrapS = THREE.RepeatWrapping;
      groundTexture.wrapT = THREE.RepeatWrapping;
      groundTexture.repeat.set(1, 1);

      // Create ground plane
      const groundGeo = new THREE.PlaneGeometry(30, 30);
      const groundMat = new THREE.MeshStandardMaterial({
        map: groundTexture,
        roughness: 0.8,
        metalness: 0.2,
      });

      const ground = new THREE.Mesh(groundGeo, groundMat);
      ground.rotation.x = -Math.PI / 2;
      ground.position.y = 0;
      ground.receiveShadow = true;
      scene.add(ground);

      // GUI Controls
      const gui = new dat.GUI();
      const lightFolder = gui.addFolder("Light");

      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° ambient light
      const ambientLight = scene.children.find(
        (child) => child.type === "AmbientLight"
      );
      lightFolder
        .add(ambientLight, "intensity", 0, 1, 0.1)
        .name("Ambient Intensity");

      lightFolder
        .add(dirLight, "intensity", 0, 2, 0.1)
        .name("Directional Intensity");
      lightFolder.add(dirLight.position, "x", -20, 20).name("DirLight X");
      lightFolder.add(dirLight.position, "y", -20, 20).name("DirLight Y");
      lightFolder.add(dirLight.position, "z", -20, 20).name("DirLight Z");
      lightFolder.open();

      // --- Load GLB Models ---

      // Setup DRACO decoder for compressed GLB files
      const draco = new THREE.DRACOLoader();
      draco.setDecoderPath(
        "https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/libs/draco/"
      );

      // Setup GLTF/GLB loader
      const gltfLoader = new THREE.GLTFLoader();
      gltfLoader.setDRACOLoader(draco);

      // Load GLB Model 1 - Center (‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô)
      gltfLoader.load(
        "https://film2147.github.io/finalwok/shiphallway.glb",
        (gltf) => {
          const model1 = gltf.scene;

          model1.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤‡πÉ‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false; // ‡∏ã‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
                  console.log("Hidden background mesh in model1:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          model1.position.set(0.5, 0.5, 0.5);
          model1.scale.set(1.5, 1.5, 1.5);
          scene.add(model1);
          clickableObjects.push(model1);

          console.log("GLB Model 1 loaded successfully");
          console.log("Clickable objects count:", clickableObjects.length);
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 1 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 1:", error);
        }
      );

      // Load GLB Model 2 - Left
      gltfLoader.load(
        "https://film2147.github.io/finalwok/spacesuit.glb",
        (gltf) => {
          const model2 = gltf.scene;

          model2.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model2:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
            }
          });

          model2.position.set(-17.07, 4.04, -46.33); // ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ ‡∏•‡∏≠‡∏¢‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
          model2.scale.set(2.5, 2.5, 2.5);
          model2.rotation.y = Math.PI / 5; // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
          scene.add(model2);
          clickableObjects.push(model2);
        }
      );

      // Load GLB Model 3 - Right
      gltfLoader.load(
        "https://film2147.github.io/finalwok/atlantis.glb",
        (gltf) => {
          const model3 = gltf.scene;

          model3.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model3:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
            }
          });

          model3.position.set(1.5, 1.5, 1.5); // ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤ ‡∏•‡∏≠‡∏¢‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
          model3.scale.set(10, 10, 10);
          model3.rotation.y = -Math.PI / 5; // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
          scene.add(model3);
          clickableObjects.push(model3);
        }
      );

      // Load GLB Model 4 - Back (‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô)
      gltfLoader.load(
        "https://film2147.github.io/finalwok/space_bunny.glb",
        (gltf) => {
          const model4 = gltf.scene;

          model4.traverse((child) => {
            if (child.isMesh) {
              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          model4.position.set(-1, 0.2, -4);
          model4.scale.set(1.5, 1.5, 1.5);
          model4.rotation.y = Math.PI; // ‡∏´‡∏°‡∏∏‡∏ô 180 ‡∏≠‡∏á‡∏®‡∏≤
          scene.add(model4);
          clickableObjects.push(model4);

          console.log("GLB Model 4 loaded successfully");
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 4 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 4:", error);
        }
      );
      // Load GLB Model 5 - Skybox Background
      gltfLoader.load(
        "https://film2147.github.io/finalwok/galaxy.glb",
        (gltf) => {
          const model5 = gltf.scene;

          model5.traverse((child) => {
            if (child.isMesh) {
              console.log(
                "Skybox mesh name:",
                child.name,
                "material:",
                child.material?.name
              );

              // Skybox ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ shadow
              child.castShadow = false;
              child.receiveShadow = false;

              if (child.material) {
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å mesh ‡πÉ‡∏ô skybox model
                child.material.side = THREE.BackSide; // ‡πÉ‡∏´‡πâ‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô
                child.material.fog = false; // ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÇ‡∏î‡∏¢ fog

                if (child.material.map) {
                  child.material.map.encoding = THREE.sRGBEncoding;
                  child.material.needsUpdate = true;
                }

                console.log("Skybox mesh visible:", child.name);
              }
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å
          model5.position.set(0, 0, 0);
          model5.scale.set(500, 500, 500); // ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å
          scene.add(model5);
          clickableObjects.push(model5);

          console.log("Skybox Model 5 loaded successfully");
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Skybox Model 5 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading Skybox Model 5:", error);
          console.log("Trying alternative skybox method...");

          // ‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î GLB ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ simple skybox ‡πÅ‡∏ó‡∏ô
          const skyGeometry = new THREE.SphereGeometry(400, 60, 40);
          const skyMaterial = new THREE.MeshBasicMaterial({
            color: 0x000033, // ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏≠‡∏ß‡∏Å‡∏≤‡∏®
            side: THREE.BackSide,
            fog: false,
          });
          const skybox = new THREE.Mesh(skyGeometry, skyMaterial);
          scene.add(skybox);
          console.log("Fallback skybox created");
        }
      );

      // Load GLB Model 6 - Additional Model
      gltfLoader.load(
        "https://film2147.github.io/finalwok/name.glb",
        (gltf) => {
          const model6 = gltf.scene;

          model6.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model6:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏•‡∏≠‡∏¢‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
          model6.position.set(29.9, 61.4, 13.8);
          model6.scale.set(2, 2, 2);
          model6.rotation.y = Math.PI / 6; // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
          model6.name = 'NameModel6'; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
          model6.userData = { originalRotationY: Math.PI / 6 }; // ‡πÄ‡∏Å‡πá‡∏ö‡∏°‡∏∏‡∏°‡πÄ‡∏î‡∏¥‡∏°
          scene.add(model6);
          clickableObjects.push(model6);

          console.log("GLB Model 6 loaded successfully");
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 6 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 6:", error);
        }
      );

      // Load GLB Model 7 - Additional Model
      gltfLoader.load(
        "https://film2147.github.io/finalwok/pbrmodel.glb",
        (gltf) => {
          const model7 = gltf.scene;

          model7.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö click detection
              if (child.name === "sign1") child.name = "pbrmodelname";
              if (child.name === "sign2") child.name = "pbabouteme";
              if (child.name === "sign3") child.name = "sign_base";

              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model7:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
              
              console.log("üîç Model7 Mesh:", child.name);
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏´‡∏•‡∏±‡∏á ‡∏•‡∏≠‡∏¢‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
          model7.position.set(27, 0.7, -8.2);
          model7.scale.set(2, 2, 2);
          
          // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ userData ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 7 - ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞
          model7.userData = { 
            isTeleportModel: true, 
            targetPosition: { x: 1.2, y: 3.1, z: -14.9 },
            targetPitch: 0 * (Math.PI / 180),   // 0 ‡∏≠‡∏á‡∏®‡∏≤ (‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡∏£‡∏á)
            targetYaw: 169 * (Math.PI / 180),   // 169 ‡∏≠‡∏á‡∏®‡∏≤ (‡∏´‡∏±‡∏ô‡∏Ç‡∏ß‡∏≤‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ô)
            modelName: 'teleport_model_7' 
          };
          model7.name = 'TeleportModel7';
          
          scene.add(model7);
          clickableObjects.push(model7);

          console.log("GLB Model 7 loaded successfully");
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 7 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 7:", error);
        }
      );

      // Load GLB Model 8 - Additional Model
      gltfLoader.load(
        "https://film2147.github.io/finalwok/back.glb", // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        (gltf) => {
          const backModelTemp = gltf.scene;

          backModelTemp.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö click detection
              console.log("üîç Model8 Mesh:", child.name);

              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model8:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î - ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
          backModelTemp.position.set(22.3, 58.2, 18.4); // ‡∏Ç‡∏¢‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ (‡∏•‡∏î x ‡∏à‡∏≤‡∏Å 29.9 ‡πÄ‡∏õ‡πá‡∏ô 20)
          // ‡∏Ç‡∏¢‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ (‡∏•‡∏î x ‡∏à‡∏≤‡∏Å 29.9 ‡πÄ‡∏õ‡πá‡∏ô 20)
          backModelTemp.scale.set(3, 3, 3);
          backModelTemp.rotation.y = Math.PI / 6; // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
          
          // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏• 8 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
          backModelTemp.userData = { isBackButton: true, modelName: 'back_model' };
          backModelTemp.name = 'BackButtonModel'; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠
          
          // ‡πÄ‡∏Å‡πá‡∏ö reference ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö animation
          model8 = backModelTemp;
          
          scene.add(backModelTemp);  
          clickableObjects.push(backModelTemp);

          console.log("GLB Model 8 (Back Button) loaded successfully");
          console.log("Model 8 userData:", model8.userData);
          console.log("Total clickable objects:", clickableObjects.length);
          console.log("Model 8 index in clickableObjects:", clickableObjects.indexOf(model8));
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 8 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 8:", error);
        }
      );

      // Load GLB Model 9 - Additional Model
      gltfLoader.load(
        "https://film2147.github.io/finalwok/aboutme.glb", // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        (gltf) => {
          const model9 = gltf.scene;

          model9.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö click detection
              console.log("üîç Model9 Mesh:", child.name);

              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model9:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î - ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
          model9.position.set(27, -0.7, -8.2); // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà
          model9.scale.set(2, 2, 2);
          
          // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ userData ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 9 - ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞
          model9.userData = { 
            isTeleportModel: true, 
            targetPosition: { x: 38.1, y: 61.8, z: 42 },
            targetPitch: 3 * (Math.PI / 180), // 3 ‡∏≠‡∏á‡∏®‡∏≤ (‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô radians)
            targetYaw: 40 * (Math.PI / 180),   // 40 ‡∏≠‡∏á‡∏®‡∏≤ (‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô radians)
            modelName: 'teleport_model_9' 
          };
          model9.name = 'TeleportModel9';
          
          scene.add(model9);  
          clickableObjects.push(model9);

          console.log("GLB Model 9 loaded successfully");
          console.log("Total clickable objects:", clickableObjects.length);
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 9 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 9:", error);
        }
      );

      // Load GLB Model 10 - Additional Model
      gltfLoader.load(
        "https://film2147.github.io/finalwok/pic.glb", // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        (gltf) => {
          const model10 = gltf.scene;

          model10.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö click detection
              console.log("üîç Model10 Mesh:", child.name);

              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model10:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î - ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
          model10.position.set(8.9, 61.8, 22.1); // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢
          model10.scale.set(10, 10, 10);
          model10.rotation.y = Math.PI / 6 + Math.PI / 2 + Math.PI / 6 + Math.PI / 2 + Math.PI / 6 + Math.PI / 5; // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
          
          // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ userData ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 10 - ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞
          model10.userData = { 
            isTeleportModel: true, 
            targetPosition: { x: 15.5, y: 2.5, z: 20.8 },
            targetPitch: -10 * (Math.PI / 180), // -10 ‡∏≠‡∏á‡∏®‡∏≤ (‡∏°‡∏≠‡∏á‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢)
            targetYaw: 90 * (Math.PI / 180),     // 90 ‡∏≠‡∏á‡∏®‡∏≤ (‡∏´‡∏±‡∏ô‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤)
            modelName: 'teleport_model_10' 
          };
          model10.name = 'TeleportModel10';
          
          scene.add(model10);  
          clickableObjects.push(model10);

          console.log("GLB Model 10 loaded successfully");
          console.log("Total clickable objects:", clickableObjects.length);
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 10 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 10:", error);
        }
      );

      // Load GLB Model 11 - Additional Model
      gltfLoader.load(
        "https://film2147.github.io/finalwok/back.glb", // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        (gltf) => {
          const model11Temp = gltf.scene;

          model11Temp.traverse((child) => {
            if (child.isMesh) {
              // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö click detection
              console.log("üîç Model11 Mesh:", child.name);

              // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î‡∏°‡∏≤
              if (child.material && child.material.name) {
                const matName = child.material.name.toLowerCase();
                if (
                  matName.includes("background") ||
                  matName.includes("sky") ||
                  matName.includes("environment") ||
                  matName.includes("skybox")
                ) {
                  child.visible = false;
                  console.log("Hidden background mesh in model11:", child.name);
                  return;
                }
              }

              child.castShadow = true;
              child.receiveShadow = true;
              if (child.material && child.material.map) {
                child.material.map.encoding = THREE.sRGBEncoding;
                child.material.needsUpdate = true;
              }
            }
          });

          // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î - ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
          model11Temp.position.set(6.1, 0.4, -5.9); // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á model 7 ‡πÅ‡∏•‡∏∞ model 10
          model11Temp.scale.set(2, 2, 2);
          model11Temp.rotation.y = Math.PI / 2 + Math.PI / 2; // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
          
          // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ userData ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 11 - ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
          model11Temp.userData = { 
            isBackButton: true, 
            modelName: 'back_model_11' 
          };
          model11Temp.name = 'BackButtonModel11';
          
          // ‡πÄ‡∏Å‡πá‡∏ö reference ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö animation
          model11 = model11Temp;
          
          scene.add(model11Temp);  
          clickableObjects.push(model11Temp);

          console.log("GLB Model 11 loaded successfully");
          console.log("Total clickable objects:", clickableObjects.length);
        },
        (progress) => {
          const percent = progress.total
            ? (progress.loaded / progress.total) * 100
            : 0;
          console.log(`Model 11 Loading: ${percent.toFixed(1)}%`);
        },
        (error) => {
          console.error("Error loading GLB Model 11:", error);
        }
      );


    // üîπ ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö FPS (Global)
      let moveForward = false,
          moveBackward = false,
          moveLeft = false,
          moveRight = false,
          moveUp = false,
          moveDown = false;

      const speed = 0.1;
 
      // üîπ ‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á
      const forwardVec = new THREE.Vector3();
      const rightVec = new THREE.Vector3();

      // üéØ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å 3D Objects
      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();
      let clickableObjects = []; // ‡πÄ‡∏Å‡πá‡∏ö objects ‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ
      
      // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö camera animation
      let isAnimating = false;
      const animationDuration = 2000; // 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      let animationStartTime = 0;
      let startPosition = new THREE.Vector3();
      let targetPosition = new THREE.Vector3();
      let startRotation = { pitch: 0, yaw: 0 };
      let targetRotation = { pitch: 0, yaw: 0 };

      // üéØ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô animate ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
      function animateCameraTo(targetPos, targetLookAt = null) {
        if (isAnimating) return; // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ animate ‡∏ã‡πâ‡∏≠‡∏ô
        
        isAnimating = true;
        animationStartTime = performance.now();
        
        // ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        startPosition.copy(camera.position);
        targetPosition.copy(targetPos);
        
        // ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        startRotation.pitch = pitch;
        startRotation.yaw = yaw;
        
        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
        if (targetLookAt) {
          const direction = new THREE.Vector3().subVectors(targetLookAt, targetPos).normalize();
          targetRotation.yaw = Math.atan2(-direction.x, -direction.z);
          targetRotation.pitch = Math.asin(direction.y);
        } else {
          // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ targetLookAt ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)
          targetRotation.pitch = initialCameraPitch;
          targetRotation.yaw = initialCameraYaw;
        }
        
        console.log(`üéØ Animating camera to: ${targetPos.x}, ${targetPos.y}, ${targetPos.z}`);
      }

      // üéØ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô animate ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
      function animateCameraToWithFixedAngle(targetPos, fixedPitch, fixedYaw) {
        if (isAnimating) return; // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ animate ‡∏ã‡πâ‡∏≠‡∏ô
        
        isAnimating = true;
        animationStartTime = performance.now();
        
        // ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        startPosition.copy(camera.position);
        targetPosition.copy(targetPos);
        
        // ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        startRotation.pitch = pitch;
        startRotation.yaw = yaw;
        
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏°‡∏∏‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å
        targetRotation.pitch = fixedPitch;
        targetRotation.yaw = fixedYaw;
        
        console.log(`üéØ Animating camera to: ${targetPos.x}, ${targetPos.y}, ${targetPos.z} with fixed angle: pitch=${fixedPitch.toFixed(2)}, yaw=${fixedYaw.toFixed(2)}`);
      }

      // üéØ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å
      function onMouseClick(event) {
        if (!isFPSMode || !isPointerLocked) return; // ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô FPS mode
        
        // ‡πÉ‡∏ô FPS mode ‡πÉ‡∏ä‡πâ raycaster ‡∏à‡∏≤‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (crosshair)
        mouse.x = 0; // ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        mouse.y = 0; // ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ raycaster ‡∏à‡∏≤‡∏Å‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        raycaster.setFromCamera(mouse, camera);
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏Å‡∏±‡∏ö objects
        const intersects = raycaster.intersectObjects(clickableObjects, true);
        
        console.log('üîç Click detected. Clickable objects:', clickableObjects.length);
        console.log('üîç Intersections found:', intersects.length);
        
        if (intersects.length > 0) {
          const clickedObject = intersects[0].object;
          const clickedPosition = intersects[0].point;
          
          console.log('üéØ Clicked object:', clickedObject.name || 'unnamed');
          
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏• 8 (back.glb) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
          // ‡∏´‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å (traverse up ‡πÑ‡∏õ‡∏´‡∏≤ parent ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô scene model)
          let parentModel = clickedObject;
          while (parentModel.parent && parentModel.parent !== scene) {
            parentModel = parentModel.parent;
          }
          
          console.log('üîç Parent model found:', parentModel);
          console.log('üîç Parent userData:', parentModel.userData);
          
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏´‡∏ô
          let isBackModel = false;
          let isTeleportModel = false;
          let teleportTarget = null;
          
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Back Model (Model 8)
          if (parentModel.userData && parentModel.userData.isBackButton === true) {
            isBackModel = true;
          } else if (clickedObject.userData && clickedObject.userData.isBackButton === true) {
            isBackModel = true;
          }
          
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Teleport Model (Model 7 ‡πÅ‡∏•‡∏∞ Model 9)
          if (parentModel.userData && parentModel.userData.isTeleportModel === true) {
            isTeleportModel = true;
            teleportTarget = parentModel.userData.targetPosition;
          } else if (clickedObject.userData && clickedObject.userData.isTeleportModel === true) {
            isTeleportModel = true;
            teleportTarget = clickedObject.userData.targetPosition;
          }
          
          console.log('üîç Is back model?', isBackModel);
          console.log('üîç Is teleport model?', isTeleportModel);
          console.log('üîç Teleport target:', teleportTarget);
          
          if (isBackModel) {
            console.log('üè† ‚úÖ Clicked Back Model (back.glb) - Returning to start position...');
            returnToStartPosition();
          } else if (isTeleportModel && teleportTarget) {
            // ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏´‡∏ô
            const modelName = (parentModel.userData && parentModel.userData.modelName) || 
                             (clickedObject.userData && clickedObject.userData.modelName) || 
                             'unknown_teleport_model';
            console.log(`üöÄ ‚úÖ Clicked Teleport Model (${modelName}) - Teleporting to special position...`);
            const targetPos = new THREE.Vector3(teleportTarget.x, teleportTarget.y, teleportTarget.z);
            
            // ‡πÉ‡∏ä‡πâ‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô userData ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            let targetPitch = 3 * (Math.PI / 180); // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 3 ‡∏≠‡∏á‡∏®‡∏≤
            let targetYaw = 40 * (Math.PI / 180);   // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 40 ‡∏≠‡∏á‡∏®‡∏≤
            
            if (parentModel.userData && parentModel.userData.targetPitch !== undefined) {
              targetPitch = parentModel.userData.targetPitch;
              targetYaw = parentModel.userData.targetYaw || 0;
            } else if (clickedObject.userData && clickedObject.userData.targetPitch !== undefined) {
              targetPitch = clickedObject.userData.targetPitch;
              targetYaw = clickedObject.userData.targetYaw || 0;
            }
            
            console.log(`üéØ Using target angles: pitch=${targetPitch.toFixed(3)}, yaw=${targetYaw.toFixed(3)}`);
            animateCameraToWithFixedAngle(targetPos, targetPitch, targetYaw);
          } else {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏• 9 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (parentModel.name === 'TeleportModel9' || clickedObject.name === 'TeleportModel9') {
              console.log('üîÑ Clicked Model 9 - Rotating Model 6 back to original position...');
              
              // ‡∏´‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏• 6 ‡πÉ‡∏ô‡∏â‡∏≤‡∏Å
              const model6 = scene.children.find(child => child.name === 'NameModel6');
              
              if (model6) {
                // ‡∏´‡∏°‡∏∏‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• 6 ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡πÄ‡∏î‡∏¥‡∏°
                const originalRotation = model6.userData.originalRotationY || Math.PI / 6;
                model6.rotation.y = originalRotation;
                console.log('‚úÖ Model 6 rotated back to original angle:', originalRotation);
              } else {
                console.log('‚ùå Model 6 not found in scene');
              }
            }
            
            console.log('üéØ Regular model clicked, moving camera closer...');
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏Ñ‡∏ß‡∏£‡πÑ‡∏õ (‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å 3 ‡∏´‡∏ô‡πà‡∏ß‡∏¢)
            const direction = new THREE.Vector3().subVectors(camera.position, clickedPosition).normalize();
            const targetPos = new THREE.Vector3().addVectors(clickedPosition, direction.multiplyScalar(3));
             
            // ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ô‡∏±‡πâ‡∏ô
            animateCameraTo(targetPos, clickedPosition);
          }
        }
      }

      // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å
      document.addEventListener('click', onMouseClick);

      // üñ±Ô∏è Event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mouse hover detection
      document.addEventListener('mousemove', onMouseMove);

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
      function returnToStartPosition() {
        if (isAnimating) return; // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ animate ‡∏ã‡πâ‡∏≠‡∏ô
        
        console.log('üè† Returning to start position...');
        animateCameraTo(initialCameraPosition, null);
        
        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        setTimeout(() => {
          pitch = initialCameraPitch;
          yaw = initialCameraYaw;
        }, 100); // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£ animate ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô
      }

      // üñ±Ô∏è ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö mouse hover
      function onMouseMove(event) {
        if (!model8 && !model11) return; // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à
        
        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì mouse position
        const rect = renderer.domElement.getBoundingClientRect();
        mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
        mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ raycaster
        raycaster.setFromCamera(mouse, camera);
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á array ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö hover
        const modelsToCheck = [];
        if (model8) modelsToCheck.push(model8);
        if (model11) modelsToCheck.push(model11);
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•
        const intersects = raycaster.intersectObjects(modelsToCheck, true);
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ hover ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 8
        const wasModel8Hovered = isModel8Hovered;
        isModel8Hovered = model8 && intersects.some(intersect => {
          let parent = intersect.object;
          while (parent && parent !== scene) {
            if (parent === model8) return true;
            parent = parent.parent;
          }
          return false;
        });
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ hover ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 11
        const wasModel11Hovered = isModel11Hovered;
        isModel11Hovered = model11 && intersects.some(intersect => {
          let parent = intersect.object;
          while (parent && parent !== scene) {
            if (parent === model11) return true;
            parent = parent.parent;
          }
          return false;
        });
        
        // ‡πÅ‡∏™‡∏î‡∏á log ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
        if (wasModel8Hovered !== isModel8Hovered) {
          console.log(`üñ±Ô∏è Model 8 hover state: ${isModel8Hovered ? 'HOVERED' : 'NOT HOVERED'}`);
        }
        if (wasModel11Hovered !== isModel11Hovered) {
          console.log(`üñ±Ô∏è Model 11 hover state: ${isModel11Hovered ? 'HOVERED' : 'NOT HOVERED'}`);
        }
        
        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô cursor style
        document.body.style.cursor = (isModel8Hovered || isModel11Hovered) ? 'pointer' : 'default';
      }

      // üî∏ Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Q ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
      document.addEventListener('keydown', (event) => {
        switch (event.code) {
          case 'KeyQ':
            event.preventDefault();
            if (isFPSMode) {
              console.log('üî¥ Exiting FPS mode...');
              exitFPSMode();
            } else {
              console.log('üü¢ Entering FPS mode...');
              enterFPSMode();
            }
            break;
          case 'KeyW': 
            if (isFPSMode) moveForward = true; 
            break;
          case 'KeyS': 
            if (isFPSMode) moveBackward = true; 
            break;
          case 'KeyA': 
            if (isFPSMode) moveLeft = true; 
            break;
          case 'KeyD': 
            if (isFPSMode) moveRight = true; 
            break;
          case 'Space': 
            if (isFPSMode) {
              event.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô scroll
              moveUp = true;
            }
            break;
          case 'ShiftLeft':
          case 'ShiftRight':
            if (isFPSMode) moveDown = true; 
            break;
        }
      });

      document.addEventListener('keyup', (event) => {
        switch (event.code) {
          case 'KeyW': 
            moveForward = false; 
            break;
          case 'KeyS': 
            moveBackward = false; 
            break;
          case 'KeyA': 
            moveLeft = false; 
            break;
          case 'KeyD': 
            moveRight = false; 
            break;
          case 'Space': 
            moveUp = false; 
            break;
          case 'ShiftLeft':
          case 'ShiftRight':
            moveDown = false; 
            break;
        }
      });

      // --- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å ---
      let isClicked = false;
      let clickTime = 0;

      // --- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö animation ‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏á ---
      let time = 0;
      let model8 = null; // ‡πÄ‡∏Å‡πá‡∏ö reference ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• 8
      let isModel8Hovered = false; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ hover ‡πÇ‡∏°‡πÄ‡∏î‡∏• 8
      let model11 = null; // ‡πÄ‡∏Å‡πá‡∏ö reference ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• 11
      let isModel11Hovered = false; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ hover ‡πÇ‡∏°‡πÄ‡∏î‡∏• 11

      // Render loop
      function animate() {
        requestAnimationFrame(animate);

    // ‚úÖ ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô FPS mode ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    if (isFPSMode) {
      const moveZ = (moveForward ? 1 : 0) - (moveBackward ? 1 : 0); // + = ‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤
      const moveX = (moveRight   ? 1 : 0) - (moveLeft     ? 1 : 0); // + = ‡πÑ‡∏õ‡∏Ç‡∏ß‡∏≤
      const moveY = (moveUp      ? 1 : 0) - (moveDown     ? 1 : 0); // + = ‡∏•‡∏≠‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô

      // ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô (X, Z)
      if (moveZ !== 0 || moveX !== 0) {
          // ‡∏´‡∏≤‡∏ó‡∏¥‡∏® "‡∏´‡∏ô‡πâ‡∏≤" ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡∏î‡πÅ‡∏Å‡∏ô Y ‡∏≠‡∏≠‡∏Å (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏≠‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° pitch)
          camera.getWorldDirection(forwardVec);
          forwardVec.y = 0;
          forwardVec.normalize();

          // ‡∏´‡∏≤‡∏ó‡∏¥‡∏® "‡∏Ç‡∏ß‡∏≤" ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
          rightVec.crossVectors(forwardVec, camera.up).normalize();

          // ‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î
          camera.position.addScaledVector(forwardVec, moveZ * speed); // W/S
          camera.position.addScaledVector(rightVec,   moveX * speed); // A/D
      }

      // ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á (Y) - ‡∏•‡∏≠‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô/‡∏•‡∏á ‡∏≠‡∏¥‡∏™‡∏£‡∏∞
      if (moveY !== 0) {
          camera.position.y += moveY * speed; // Space/Shift
      }
    }

    // üéØ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£ animate ‡∏Å‡∏•‡πâ‡∏≠‡∏á
    if (isAnimating) {
      const elapsed = performance.now() - animationStartTime;
      const progress = Math.min(elapsed / animationDuration, 1);
      
      // Smooth easing function
      const easedProgress = progress * progress * (3 - 2 * progress);
      
      // Interpolate position
      camera.position.lerpVectors(startPosition, targetPosition, easedProgress);
      
      // Interpolate rotation
      pitch = startRotation.pitch + (targetRotation.pitch - startRotation.pitch) * easedProgress;
      yaw = startRotation.yaw + (targetRotation.yaw - startRotation.yaw) * easedProgress;
      
      // Apply rotation
      camera.rotation.order = 'YXZ';
      camera.rotation.y = yaw;
      camera.rotation.x = pitch;
      
      // ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£ animate
      if (progress >= 1) {
        isAnimating = false;
      }
    }

    // üîπ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï GUI ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á
    const yawDegrees = (yaw * 180 / Math.PI).toFixed(0);
    const pitchDegrees = (pitch * 180 / Math.PI).toFixed(0);
    info.textContent = `Position: X:${camera.position.x.toFixed(1)} Y:${camera.position.y.toFixed(1)} Z:${camera.position.z.toFixed(1)} | Rotation: Yaw:${yawDegrees}¬∞ Pitch:${pitchDegrees}¬∞ | FPS Mode: ${isPointerLocked ? 'ON' : 'OFF'}`;

    // --- ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÄ‡∏ö‡∏≤‡πÜ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å (‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô) ---
    // ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏°‡πà‡∏´‡∏°‡∏∏‡∏ô ‡πÅ‡∏ï‡πà‡πÉ‡∏´‡πâ‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ú‡πà‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö camera animation

    // --- Animation breath ‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡πÇ‡∏°‡πÄ‡∏î‡∏• 8 ‡πÅ‡∏•‡∏∞ ‡πÇ‡∏°‡πÄ‡∏î‡∏• 11) ---
    if (model8 || model11) {
      time += 0.02;
      
      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•
      const applyModelColorEffect = (model, isHovered, baseColor = 0x84C1FF) => {
        model.traverse((child) => {
        if (child.isMesh && child.material) {
          
          // üé® ‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ï‡∏•‡∏≠‡∏î (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢)
          const baseColor = 0x84C1FF; // ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏™‡∏î (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ)
          
          if (isHovered) {
            // üñ±Ô∏è ‡πÄ‡∏°‡∏∑‡πà‡∏≠ hover - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÅ‡∏î‡∏á‡∏™‡∏î‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÑ‡∏°‡πà‡∏°‡∏µ animation)
            const hoverColor = 0xFF6600; // ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÅ‡∏î‡∏á‡∏™‡∏î
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠ hover (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)
            child.material.color.setHex(hoverColor);
            
            // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÅ‡∏™‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏á‡∏ó‡∏µ‡πà
            if (child.material.emissive) {
              child.material.emissive.setHex(0xFF4400); // ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÄ‡∏Ç‡πâ‡∏°
              child.material.emissiveIntensity = 0.6; // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ñ‡∏á‡∏ó‡∏µ‡πà
            }
            
          } else {
            // ÔøΩ ‡∏™‡∏µ‡∏õ‡∏Å‡∏ï‡∏¥ - breath effect ‡∏Å‡∏±‡∏ö‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
            
            // Breath effect - ‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏ä‡πâ‡∏≤‡πÜ ‡∏™‡∏á‡∏ö
            const breathIntensity = (Math.sin(time * 1.5) * 0.2 + 0.8); // 0.6-1.0 range
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏ï‡∏≤‡∏° breath intensity
            const r = Math.floor(((baseColor >> 16) & 0xFF) * breathIntensity);
            const g = Math.floor(((baseColor >> 8) & 0xFF) * breathIntensity);
            const b = Math.floor((baseColor & 0xFF) * breathIntensity);
            const breathColor = (r << 16) | (g << 8) | b;
            
            child.material.color.setHex(breathColor);
            
            // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÅ‡∏™‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢
            if (child.material.emissive) {
              // ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÅ‡∏ï‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤
              const emissiveR = Math.floor(r * 0.4);
              const emissiveG = Math.floor(g * 0.4);
              const emissiveB = Math.floor(b * 0.4);
              const emissiveColor = (emissiveR << 16) | (emissiveG << 8) | emissiveB;
              
              child.material.emissive.setHex(emissiveColor);
              child.material.emissiveIntensity = breathIntensity * 0.5;
            }
          }
          
          child.material.needsUpdate = true;
        }
      });
      };
      
      // ‡πÉ‡∏ä‡πâ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 8
      if (model8) {
        applyModelColorEffect(model8, isModel8Hovered, 0x84C1FF); // ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏™‡∏î
      }
      
      // ‡πÉ‡∏ä‡πâ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 11
      if (model11) {
        applyModelColorEffect(model11, isModel11Hovered, 0x84C1FF); // ‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• 8
      }
    }

    // üî∏ ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏â‡∏≤‡∏Å
    renderer.render(scene, camera);
}

      // --- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•) ---
      // ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö FPS mode ‡∏Å‡∏±‡∏ö onMouseClick function ‡πÅ‡∏ó‡∏ô

animate();
    </script>
  </body>
</html>
